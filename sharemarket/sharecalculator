<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NEPSE Share Calculator</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f7fa;
      padding: 20px;
    }

    .container {
      max-width: 750px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    h2 {
      margin-bottom: 20px;
      border-bottom: 2px solid orange;
      display: inline-block;
      font-size: 24px;
    }

    h2 span {
      color: orange;
    }

    .tabs {
      margin-bottom: 20px;
    }

    .tabs button {
      padding: 10px 20px;
      margin-right: 10px;
      border: none;
      cursor: pointer;
      background: #eee;
      border-radius: 5px 5px 0 0;
      font-weight: bold;
    }

    .tabs button.active {
      background: orange;
      color: black;
      border-bottom: 2px solid white;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .form-group {
      flex: 1;
      min-width: 200px;
    }

    label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }

    input[type="number"] {
      width: 100%;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    .buttons {
      margin-top: 20px;
    }

    .calc-btn {
      background: orange;
      color: black;
      border: 2px solid black;
      padding: 10px 20px;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
    }

    .calc-btn:hover {
      background: #e68a00;
    }

    .result {
      margin-top: 30px;
      padding: 20px;
      background: #f1f1f1;
      border-radius: 10px;
      font-weight: bold;
    }

    .result p {
      margin: 5px 0;
    }

    @media (max-width: 600px) {
      .form-row {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

  <div class="container">
    <h2>Share <span>Calculator</span></h2>

    <div class="tabs">
      <button class="active" onclick="showTab('buy')">Buy</button>
      <button onclick="showTab('sell')">Sell</button>
    </div>

    <!-- Buy Calculator -->
    <div id="buy" class="tab-content active">
      <div class="form-row">
        <div class="form-group">
          <label for="buyQty">Quantity</label>
          <input type="number" id="buyQty" placeholder="Enter number of shares">
        </div>
        <div class="form-group">
          <label for="buyRate">Rate per Share (Rs.)</label>
          <input type="number" id="buyRate" placeholder="Enter rate per share">
        </div>
      </div>
      <div class="buttons">
        <button class="calc-btn" onclick="calculateBuy()">Calculate</button>
      </div>
      <div class="result" id="buyResult" style="display:none;"></div>
    </div>

    <!-- Sell Calculator -->
    <div id="sell" class="tab-content">
      <div class="form-row">
        <div class="form-group">
          <label for="sellQty">Quantity</label>
          <input type="number" id="sellQty" placeholder="Enter number of shares">
        </div>
        <div class="form-group">
          <label for="sellRate">Rate per Share (Rs.)</label>
          <input type="number" id="sellRate" placeholder="Enter selling rate per share">
        </div>
        <div class="form-group">
          <label for="buyPrice">Buy Price per Share (for CGT)</label>
          <input type="number" id="buyPrice" placeholder="Enter your buy price per share">
        </div>
      </div>
      <div class="buttons">
        <button class="calc-btn" onclick="calculateSell()">Calculate</button>
      </div>
      <div class="result" id="sellResult" style="display:none;"></div>
    </div>
  </div>

  <script>
    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      event.target.classList.add('active');
    }

    function getBrokerCommissionRate(amount) {
      if (amount <= 50000) return 0.0036;
      if (amount <= 500000) return 0.0033;
      if (amount <= 2000000) return 0.0031;
      if (amount <= 10000000) return 0.0027;
      return 0.0024;
    }

    function calculateBuy() {
      const qty = parseFloat(document.getElementById("buyQty").value);
      const rate = parseFloat(document.getElementById("buyRate").value);

      if (!qty || !rate || qty <= 0 || rate <= 0) {
        alert("Enter valid quantity and rate.");
        return;
      }

      const gross = qty * rate;
      const commRate = getBrokerCommissionRate(gross);
      const commission = gross * commRate;
      const sebon = gross * 0.00015;
      const dp = 25;
      const total = gross + commission + sebon + dp;

      document.getElementById("buyResult").innerHTML = `
        <p>Gross Amount: Rs. ${gross.toFixed(2)}</p>
        <p>Broker Commission (${(commRate * 100).toFixed(2)}%): Rs. ${commission.toFixed(2)}</p>
        <p>SEBON Fee (0.015%): Rs. ${sebon.toFixed(2)}</p>
        <p>DP Charge: Rs. ${dp}</p>
        <hr>
        <p>Total Payable Amount: <strong>Rs. ${total.toFixed(2)}</strong></p>
      `;
      document.getElementById("buyResult").style.display = "block";
    }

    function calculateSell() {
      const qty = parseFloat(document.getElementById("sellQty").value);
      const rate = parseFloat(document.getElementById("sellRate").value);
      const buyPrice = parseFloat(document.getElementById("buyPrice").value);

      if (!qty || !rate || !buyPrice || qty <= 0 || rate <= 0 || buyPrice <= 0) {
        alert("Enter valid values in all fields.");
        return;
      }

      const gross = qty * rate;
      const commRate = getBrokerCommissionRate(gross);
      const commission = gross * commRate;
      const sebon = gross * 0.00015;
      const dp = 25;
      const gain = (rate - buyPrice) * qty;
      const cgt = gain > 0 ? gain * 0.05 : 0;
      const net = gross - commission - sebon - dp - cgt;

      document.getElementById("sellResult").innerHTML = `
        <p>Gross Amount: Rs. ${gross.toFixed(2)}</p>
        <p>Broker Commission (${(commRate * 100).toFixed(2)}%): Rs. ${commission.toFixed(2)}</p>
        <p>SEBON Fee (0.015%): Rs. ${sebon.toFixed(2)}</p>
        <p>DP Charge: Rs. ${dp}</p>
        <p>Capital Gain Tax (5%): Rs. ${cgt.toFixed(2)}</p>
        <hr>
        <p>Net Receivable Amount: <strong>Rs. ${net.toFixed(2)}</strong></p>
      `;
      document.getElementById("sellResult").style.display = "block";
    }
  </script>

</body>
</html>
